<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.3">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Material+Icons">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-react-helmet="true">4.4 Solidification | Research Specifications</title><meta data-react-helmet="true" property="og:url" content="https://v2.docs.iota.org/docs/4.4 Solidification"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="4.4 Solidification | Research Specifications"><meta data-react-helmet="true" name="description" content="A message is solid if all its parents are stored, solid and valid. This section defines how messages get solid in the Tangle."><meta data-react-helmet="true" property="og:description" content="A message is solid if all its parents are stored, solid and valid. This section defines how messages get solid in the Tangle."><link data-react-helmet="true" rel="shortcut icon" href="/img/logo/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://v2.docs.iota.org/docs/4.4 Solidification"><link data-react-helmet="true" rel="alternate" href="https://v2.docs.iota.org/docs/4.4 Solidification" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://v2.docs.iota.org/docs/4.4 Solidification" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.26e5e924.css">
<link rel="preload" href="/assets/js/runtime~main.c21840c0.js" as="script">
<link rel="preload" href="/assets/js/main.b37c3345.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo/Logo_Swirl_Dark.png" alt="IOTA" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo/Logo_Swirl_Dark.png" alt="IOTA" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/preface">Specification</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/iotaledger/IOTA-2.0-Research-Specifications" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--checked react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" checked="" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo/Logo_Swirl_Dark.png" alt="IOTA" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo/Logo_Swirl_Dark.png" alt="IOTA" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link navbar__link--active" href="/docs/preface">Specification</a></li><li class="menu__list-item"><a href="https://github.com/iotaledger/IOTA-2.0-Research-Specifications" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/preface">Preface</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/1.1 Introduction">1.1 Introduction</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/2.2 Message Layout">2.2 Message Layout</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/2.3 Standard Payloads Layout">2.3 Standard Payloads Layout</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/2.4 Data Flow">2.4 Data flow</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/3.3 Peer Discovery">3.3 Peer Discovery</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/3.4 Neighbor Selection">3.4 Neighbor Selection</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/4.1 The Tangle">4.1 The Tangle</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/4.2 Timestamps">4.2 Timestamps</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/4.3 Tip Selection Algorithm">4.3 Tip Selection Algorithm</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" href="/docs/4.4 Solidification">4.4 Solidification</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/4.5 Rate Control">4.5 Rate Control through Adaptive Proof of Work</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/4.6 Congestion Control">4.6 Congestion control</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/4.7 Markers">4.7 Markers</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/5.1 UTXO">5.1 UTXO</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/5.2 Ledger State">5.2 Ledger State</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/5.3 Mana">5.3 Mana</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/6.1 Objects of Consensus">6.1 Objects of Consensus</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/6.2 Opinion Setting">6.2 Opinion Setting</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/6.3 Fast Probabilistic Consensus">6.3 Fast Probabilistic Consensus</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/6.4 Finalization">6.4 Approval Weight and Finality</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/6.5 dRNG">6.5 Distributed Random Number Generator</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><h1 id="44-solidification">4.4 Solidification</h1><p>A message is solid if all its parents are stored, solid and valid. This section defines how messages get solid in the Tangle.</p><p>The Solidification specification depends on the following specifications:</p><ul><li><a href="./4.2%20Timestamps">4.2 - Timestamps</a></li><li><a href="./5.1%20UTXO">5.1 - UTXO</a></li></ul><h2 id="441-motivation">4.4.1 Motivation</h2><p><strong>Solidification</strong> is a process of requesting missing referenced messages. It may be recursively repeated until all of a message&#x27;s past cone up to the genesis (or snapshot) becomes solid.</p><p>In that way, the Tangle enables all nodes to retrieve all of a message&#x27;s history, even the ones joining the network at a point later in time.</p><h2 id="442-definitions">4.4.2 Definitions</h2><ul><li><p><strong>valid</strong>:
A message validity status is initialized as <em>valid</em>, and it&#x27;s set as <em>invalid</em> whenever the message does not pass any of the filters from the solidifier and from the message booker:</p></li><li><p>Solidifier: checks if parents are valid,</p></li><li><p>Booker: checks if the contained transaction is valid. Note that only messages containing a transaction are required to perform this check, which are defined in <a href="./5.1%20UTXO#validation">Section 5.1 - UTXO</a></p></li><li><p><strong>parents age check</strong>: A check that ensures the timestamps of parents and child are valid, following the details defined in <a href="./4.2%20Timestamps">Section 4.2 - Timestamps</a>.</p></li><li><p><strong>solid</strong>: A message is solid if it passes the solidification check and all its parents are stored in the storage, solid and their validity status is set as valid.</p></li></ul><h2 id="443-parameters">4.4.3 Parameters</h2><ul><li><code>retryInterval</code>: The time interval of resending the same solidification request.</li><li><code>maxRequestThreshold</code>: The maximum retry times to send a solidification request.</li></ul><h2 id="444-solidification-and-solidfication-check">4.4.4 Solidification and solidfication check</h2><p>During solidification, if a node is missing a referenced message, the corresponding message ID is stored in the <code>solidification buffer</code>. A node asks its neighbors for the missing message by sending a <code>solidification request</code> containing the message ID.
It also sets a boolean flag <code>isStrongRequest</code> for whether the missing message was requested as a strong (<code>TRUE</code>) or weak (<code>FALSE</code>) parent. This information can be used to decide which checks a message shall pass, when the message is received. </p><p>Note that through the following process the parents of a message that is requested through a weak solidification are not requested, and also the message does not have to pass the parent age check.</p><p>If a message gets solid, it shall walk through the rest of the data flow, then propagate the solid status to its future cone by performing the solidification checks on each of the message in its future cone again.</p><h3 id="strong-solidification">Strong solidification:</h3><p>Once the requested message is received from its neighbors, its message ID shall be removed from the <code>solidification buffer</code>. If <code>isStrongRequest==TRUE</code> the requested message is marked as solid after it passes the strong solidification checks. If any of the checks fails, the message remains unsolid, or is set to invalid, see. Image 4.4.1.</p><p>In the strong solidification check we check if</p><ol><li>the parents exist;</li><li>the parents are solid, and if not wait until these get solid;</li><li>the parents age check passes,</li><li>the parents are valid.</li></ol><h3 id="weak-solidification">Weak solidification:</h3><p>Once the requested message is received from its neighbors, its message ID shall be removed from the <code>solidification buffer</code>. If <code>isStrongRequest==FALSE</code> the requested message is marked as solid.</p><p>No weak solidification check has to be performed.</p><p><img src="https://user-images.githubusercontent.com/11289354/117009286-28333200-ad1e-11eb-8d0d-186c8d8ce373.png" alt="GoShimmer-flow-solidification_spec"></p><p><strong>Image 4.4.1:</strong> Strong solidification process.</p><h2 id="445-communication-details">4.4.5 Communication details</h2><p>Nodes send and receive <code>solidification request/response</code> via gossip layer. The <code>solidification request</code> is created and scheduled by the gossip manager, if a node does not get the requested message, the gossip manager re-sends it every <code>retryInterval</code>. If the requested message is not received within <code>maxRequestThreshold</code> rounds, the <code>solidification request</code> must be removed from the <code>solidification buffer</code>.</p><h3 id="4451-request-and-response">4.4.5.1 Request and response</h3><p>Below we define the form of SolidificationRequest and SolidificationResponse: </p><h3 id="solidificationrequest">SolidificationRequest</h3><table><tr><th>Name</th><th>Type</th><th>Description</th></tr><tr><td>type</td><td>uint8</td><td>Indicates that the packet is SolidificationRequest.</td></tr><tr><td>messageID</td><td>ByteArray[32]</td><td>Contains the message ID of the requested message.</td></tr></table><p><strong>Table 4.4.2:</strong> SolidificationRequest data fields description.</p><h3 id="solidificationresponse">SolidificationResponse</h3><table><tr><th>Name</th><th>Type</th><th>Description</th></tr><tr><td>type</td><td>uint8</td><td>Indicates that the packet is SolidificationResponse.</td></tr><tr><td>message</td><td>ByteArray</td><td>Contains the entire requested message.</td></tr></table><p><strong>Table 4.4.3:</strong> SolidificationResponses data fields description.</p><h2 id="446-denial-of-service">4.4.6 Denial of Service</h2><p>All requests/responses exchanged during the solidification are sent via UDP. As such, any UDP based Denial of Service attack may harm the normal functionality of the solidification. To limit this, hardware based protection such as firewall or alternatively may be used.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/iotaledger/IOTA-2.0-Research-Specifications/edit/main/docs/4.4 Solidification.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/4.3 Tip Selection Algorithm"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« 4.3 Tip Selection Algorithm</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/4.5 Rate Control"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">4.5 Rate Control through Adaptive Proof of Work Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#441-motivation" class="table-of-contents__link">4.4.1 Motivation</a></li><li><a href="#442-definitions" class="table-of-contents__link">4.4.2 Definitions</a></li><li><a href="#443-parameters" class="table-of-contents__link">4.4.3 Parameters</a></li><li><a href="#444-solidification-and-solidfication-check" class="table-of-contents__link">4.4.4 Solidification and solidfication check</a><ul><li><a href="#strong-solidification" class="table-of-contents__link">Strong solidification:</a></li><li><a href="#weak-solidification" class="table-of-contents__link">Weak solidification:</a></li></ul></li><li><a href="#445-communication-details" class="table-of-contents__link">4.4.5 Communication details</a><ul><li><a href="#4451-request-and-response" class="table-of-contents__link">4.4.5.1 Request and response</a></li><li><a href="#solidificationrequest" class="table-of-contents__link">SolidificationRequest</a></li><li><a href="#solidificationresponse" class="table-of-contents__link">SolidificationResponse</a></li></ul></li><li><a href="#446-denial-of-service" class="table-of-contents__link">4.4.6 Denial of Service</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Specification</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/preface">Specification</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://discord.iota.org" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/iota" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://iota.stackexchange.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Stack Exchange<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/iotaledger/IOTA-2.0-Research-Specifications" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 IOTA Foundation. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.c21840c0.js"></script>
<script src="/assets/js/main.b37c3345.js"></script>
</body>
</html>